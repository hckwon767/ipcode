name: ğŸ”„ Auto Update Proxy List (6 Hours)

on:
  # 6ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰ (0, 6, 12, 18ì‹œ UTC)
  schedule:
    - cron: '0 */6 * * *' 
  # ìˆ˜ë™ ì‹¤í–‰ì„ ìœ„í•œ ì›Œí¬í”Œë¡œìš° ë””ìŠ¤íŒ¨ì¹˜
  workflow_dispatch:

jobs:
  update:
    runs-on: ubuntu-latest
    
    # GITHUB_TOKENì´ ì“°ê¸° ê¶Œí•œì„ ê°€ì§€ë„ë¡ ì„¤ì • (íŒŒì¼ ì»¤ë°‹/í‘¸ì‹œë¥¼ ìœ„í•´ í•„ìˆ˜)
    permissions:
      contents: write
      
    steps:
      - name: â¬‡ï¸ Checkout Repository
        # ì €ì¥ì†Œì˜ ì½”ë“œë¥¼ ì›Œí¬í”Œë¡œìš° í™˜ê²½ìœ¼ë¡œ ê°€ì ¸ì˜µë‹ˆë‹¤.
        uses: actions/checkout@v4
        
      - name: ğŸ Set up Python 3.x
        # Python í™˜ê²½ì„ ì„¤ì •í•˜ê³  PyYAML ë° requests ì„¤ì¹˜ì— í•„ìš”í•œ ìºì‹œë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: ğŸ“¦ Install Dependencies (requests, PyYAML)
        # requirements.txt íŒŒì¼ì— ì •ì˜ëœ ì˜ì¡´ì„±ì„ ì„¤ì¹˜í•©ë‹ˆë‹¤.
        run: pip install -r requirements.txt

      - name: ğŸš€ Run Proxy Update Script
        # Python ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•˜ì—¬ cfproxy.txt íŒŒì¼ì„ ìƒì„±í•˜ê±°ë‚˜ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
        run: python update_proxy.py

      - name: ğŸ’¾ Commit and Push changes
        # ë³€ê²½ëœ íŒŒì¼(cfproxy.txt)ì´ ìˆë‹¤ë©´ ìë™ìœ¼ë¡œ ì»¤ë°‹í•˜ê³  í‘¸ì‹œí•©ë‹ˆë‹¤.
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          file_pattern: 'cfproxy.txt' 
          commit_message: "ğŸ¤– Feat: cfproxy.txt ìë™ ì—…ë°ì´íŠ¸"
          
          # (ì„ íƒ ì‚¬í•­) Action ìì²´ì˜ ê²€ì‚¬ë¥¼ ê±´ë„ˆë›°ì–´ ì•ˆì •ì„± í–¥ìƒ
          skip_dirty_check: true
